<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>대중 참여형 정책 수립을 위한 크라우드소싱 정책 플랫폼 고안</title>
    <link href="http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700" rel='stylesheet' type='text/css'>
    <style>
        body {
            font-family: "open sans";
        }
        #main {
            margin-left: 30px;
            width: 600px;
        }
        #main div {
            margin: 15px;
        }
        .instruction {
            font-weight: bold;
        }
        h3 {
            color: teal;
        }
        a, a:active, a:visited {
            color: #222;
            font-weight: bold;
            font-size: 18px;
        }
        a:hover {
            color: teal;
        }
    </style>
</head>

<body>
<div class="container">
    <div id="tabs" class="clearfix">
        <h1>대중 참여형 정책 수립을 위한 크라우드소싱 정책 플랫폼 고안</h1>
    </div>

    <div id="main">
        <div id="leftpane">
            <h2>참가자 ID: <span class="participant-id"></span></h2>
            <div>
                "대중 참여형 정책 수립을 위한 크라우드소싱 정책 플랫폼 고안" 연구 관련 실험에 참여해 주셔서 감사합니다. 다음은 실험 순서 및 방법에 대한 안내사항입니다. 실험 도중에 문의사항이 있으실 경우 실험 진행자에게 알려주시기 바랍니다.
            </div>
            <div id="tasks">

            <h3>1.실험 전 설문 (5분)</h3>
                <div>
                <h4><span class='progress'>&nbsp;&nbsp;&nbsp;</span>
                <a target="_blank" href="" id="preQ">[실험 전 설문]</a></h4>
                </div>

            <h3>2. 인터페이스 Tutorial (5분)</h3>
                <div>
                실험 참여자 분들은 주어진 인터페이스를 통해 총 3개의 기사를 읽고 활동하시게 됩니다. <br/>
                <h4><span class='progress'>&nbsp;&nbsp;&nbsp;</span>
                <a target="_blank" href="" id="tutorialQ">[인터페이스 사용 방법]</a></h4>
                </div>

            <h3>3. 본 실험 (총 30분)</h3>
                <div>
본 실험에서 귀하는 총 3개의 기사를 읽고 활동하시게 됩니다. <span class="instruction"></span> 기사를 읽기 전에 매번 기사 읽기 전 설문조사를 하시고 기사 관련 활동을 하신 뒤 기사 읽은 후 설문조사를 해주시면 됩니다.
<br/><br/>
<strong>Note: 기사 관련 활동에 적극적으로 참여해주신 두 분을 선정하여 추가 실험비를 지급할 계획입니다.</strong>
<br/><br/>
각 기사마다 7분의 활동시간이 주어지며 실험 진행자가 3분 전, 1분 전에 알려드립니다. 7분 이내에 활동이 끝난 경우에는 다음 단계로 넘어가지 마시고 안내가 있을 때까지 대기해 주시기 바랍니다.<br/>


                <h3>기사 1: <span id="issue1"></span></h3>

                <h4><span class='progress'>&nbsp;&nbsp;&nbsp;</span>
                <a target="_blank" href="" class="preArticleQ">[기사 읽기 전 설문]</a></h4>

                <div>다음 안내 시까지 대기해 주세요.</div>

                <h4><span class='progress'>&nbsp;&nbsp;&nbsp;</span>
                <a target="_blank" href="" id="explore1">[기사 읽기]</a> <small>(7분) 로그인 ID: <span class="participant-id"></span>, 패스워드: test</small></h4>

                <div>다음 안내 시까지 대기해 주세요.</div>

                <h4><span class='progress'>&nbsp;&nbsp;&nbsp;</span>
                <a target="_blank" href="" class="postArticleQ">[기사 읽은 후 설문]</a></h4>

                <div>다음 안내 시까지 대기해 주세요.</div>

                <h3>기사 2: <span id="issue2"></span></h3>

                <h4><span class='progress'>&nbsp;&nbsp;&nbsp;</span>
                <a target="_blank" href="" class="preArticleQ">[기사 읽기 전 설문]</a></h4>

                <div>다음 안내 시까지 대기해 주세요.</div>

                <h4><span class='progress'>&nbsp;&nbsp;&nbsp;</span>
                <a target="_blank" href="" id="explore2">[기사 읽기]</a> <small>(7분) 로그인 ID: <span class="participant-id"></span>, 패스워드: test</small></h4>

                <div>다음 안내 시까지 대기해 주세요.</div>

                <h4><span class='progress'>&nbsp;&nbsp;&nbsp;</span>
                <a target="_blank" href="" class="postArticleQ">[기사 읽은 후 설문]</a></h4>

                <div>다음 안내 시까지 대기해 주세요.</div>

                <h3>기사 3: <span id="issue3"></span></h3>

                <h4><span class='progress'>&nbsp;&nbsp;&nbsp;</span>
                <a target="_blank" href="" class="preArticleQ">[기사 읽기 전 설문]</a></h4>

                <div>다음 안내 시까지 대기해 주세요.</div>

                <h4><span class='progress'>&nbsp;&nbsp;&nbsp;</span>
                <a target="_blank" href="" id="explore3">[기사 읽기]</a> <small>(7분) 로그인 ID: <span class="participant-id"></span>, 패스워드: test</small></h4>

                <div>다음 안내 시까지 대기해 주세요.</div>

                <h4><span class='progress'>&nbsp;&nbsp;&nbsp;</span>
                <a target="_blank" href="" class="postArticleQ">[기사 읽은 후 설문]</a></h4>

                <div>다음 안내 시까지 대기해 주세요.</div>

                </div>
            <h3>4. 실험 후 설문(10분)</h3>
                <div>
                <h4><span class='progress'>&nbsp;&nbsp;&nbsp;</span>
                <a target="_blank" href="" id="postQ">[실험 후 설문]</a></h4>
                </div>

            <h3>5. 국가 재정 지출 인식 조사(10~15분)</h3>
                <div>
                서울시가 아닌 국가 전체의 재정 지출에 대한 설문조사입니다. 아래 링크를 클릭해 몇가지 문항에 답변해 주시면 됩니다.
                <h4><span class='progress'>&nbsp;&nbsp;&nbsp;</span>
                <a target="_blank" href="" id="finalQ">[국가 재정 지출 인식 조사]</a></h4>
                </div>
        </div>
    </div>
    <hr>
    <div class="clearfix">
        <div>실험에 참여해 주셔서 감사합니다. </div>
        <br/><br/>
    </div>
</div>

    <script src="//code.jquery.com/jquery-1.11.0.min.js"></script>

    <script>
    function gup(name) {
        var match = RegExp('[?&]' + name + '=([^&]*)').exec(window.location.search);
        return match && decodeURIComponent(match[1].replace(/\+/g, ' '));
    }

    var pid = gup("pid");

    var preQ = "https://docs.google.com/forms/d/1ByZyvjt1U3HVAD6qYZypLCuW14JpxfqEoi-6bgrXuA8/viewform";
    var tutorialQA = "https://docs.google.com/document/d/1SLaBETiFwPj6Mw38AAL39kNIHDZ0FLN-nRGyyu_59Dg/edit";
    var tutorialQB = "https://docs.google.com/document/d/13qNzxLkeXvL-Z4hNVRdVYwd3pONrsIWdYE_lqUIU2sM/edit";
    var tutorialQC = "https://docs.google.com/document/d/1Y5llB-dByUQ9dSzoTbi2ZIZqEdGfQhCm21m0ksxjvvA/edit";
    var preArticleQ = "https://docs.google.com/forms/d/1jfZR_IXc-Truz6xR4BNAhqW_uOA8NJRKrrkVQT1wIDE/viewform";
    var postArticleQ = "https://docs.google.com/forms/d/1g2s06Wa6KeoT-GUQtZMcX1OifMcqoWQjuhKQmwnH8E4/viewform";

    var postQA = "https://docs.google.com/forms/d/16mou_Z-QrRP27O-mDeOXs-BwJuGeeAOk9Fe2XupJDUM/viewform";
    var postQB = "https://docs.google.com/forms/d/1cliMFqESt2jpyyqY1pO4BB5PC5M2Hp-QXzrIvXgAP_8/viewform";
    var postQC = "https://docs.google.com/forms/d/13ZLbTT3NlAI90N5jcp5C19nQs5Nzbr_FOxaNBZIV5zA/viewform";

    var finalQ = "https://qtrial2014.az1.qualtrics.com/SE/?SID=SV_cHikimqwyCbJWpT";


    var instructions = ["기사를 읽고 인터페이스를 활용해 적극적으로 토론에 참여해 보세요.", "기사를 읽고 인터페이스를 활용해 적극적으로 토론과 사실확인에 참여해 보세요.", "기사를 읽고 주어진 정보와 인터페이스를 활용해 적극적으로 토론과 사실확인에 참여해 보세요."]

    var numParticipants = 36;
    var numTasks = 3;

    var issues = ["아리수", "서해뱃길 유람선", "친환경급식"];
    var mappings = [
        ["A", "B", "C"], ["A", "C", "B"], ["B", "C", "A"], ["B", "A", "C"], ["C", "A", "B"], ["C", "B", "A"]
    ];

/*
아리수 기사 : http://jonghyuk.info:3000/factful/article/item/54067643eded86d04b02bfe6
유람선 기사 : http://jonghyuk.info:3000/factful/article/item/5406768beded86d04b02bffc
급식 기사 : http://jonghyuk.info:3000/factful/article/item/540676c5eded86d04b02c006

아리수 기사 : http://jonghyuk.info:4000/factful/article/item/540677d4633608034c68992a
유람선 기사 : http://jonghyuk.info:4000/factful/article/item/54067822633608034c689956
급식 기사 : http://jonghyuk.info:4000/factful/article/item/5406785f633608034c689962

아리수 기사 : http://jonghyuk.info:5000/factful/article/item/54067a46d1ac23474cc62d90
유람선 기사 : http://jonghyuk.info:5000/factful/article/item/54067a93d1ac23474cc62dbc
급식 기사 : http://jonghyuk.info:5000/factful/article/item/54067b00d1ac23474cc62dca
*/
    var conditions = {};

    function createUrl(interface, issue) {
        var index;
        var result;
        if (interface == "A") {
            if (issue == "A")
                result = "http://jonghyuk.info:3000/factful/article/item/54067643eded86d04b02bfe6";
            else if (issue == "B")
                result = "http://jonghyuk.info:3000/factful/article/item/5406768beded86d04b02bffc";
            else if (issue == "C")
                result = "http://jonghyuk.info:3000/factful/article/item/540676c5eded86d04b02c006";
        } else if (interface == "B") {
            if (issue == "A")
                result = "http://jonghyuk.info:4000/factful/article/item/540677d4633608034c68992a";
            else if (issue == "B")
                result = "http://jonghyuk.info:4000/factful/article/item/54067822633608034c689956";
            else if (issue == "C")
                result = "http://jonghyuk.info:4000/factful/article/item/5406785f633608034c689962";
        } else if (interface == "C") {
            if (issue == "A")
                result = "http://jonghyuk.info:5000/factful/article/item/54067a46d1ac23474cc62d90";
            else if (issue == "B")
                result = "http://jonghyuk.info:5000/factful/article/item/54067a93d1ac23474cc62dbc";
            else if (issue == "C")
                result = "http://jonghyuk.info:5000/factful/article/item/54067b00d1ac23474cc62dca";
        }
        console.log(result);
        return result;
    }

    function getIssue(issue){
        if (issue == "A")
            return issues[0];
        else if (issue == "B")
            return issues[1];
        else if (issue == "C")
            return issues[2];
    }

    function getInstruction(interface) {
        if (interface == "A")
            return instructions[0];
        else if (interface == "B")
            return instructions[1];
        else if (interface == "C")
            return instructions[2];
    }

    function createTasks() {
        var i, j, itype, taskOrder;
        var taskCount = 0;
        for (i = 1; i <= numParticipants; i++) {
            console.log("Participant", i);
            taskOrder = mappings[(i-1) % 6];
            if (i >= 1 && i <= 12)
                itype = "A";
            else if (i >= 13 && i <= 24)
                itype = "B";
            else if (i >= 25 && i <= 36)
                itype = "C";
            for (j = 0; j < numTasks; j++) {
                taskCount += 1;
                // taskOrder = taskCount % tseq.length;
                console.log(itype, taskOrder[j]);
                conditions[taskCount] = {
                    "pid": itype + ((i-1) % 12 + 1),
                    "tid": taskCount,
                    "torder": j + 1,
                    "itype": itype,
                    "issue": taskOrder[j],
                    "url": createUrl(itype, taskOrder[j])
                }
            }

        }
        console.log(taskCount, "tasks created");
        // console.log(conditions);

        for (var cond in conditions) {
            console.log("pid:", conditions[cond].pid, "tid:", conditions[cond].tid, "torder:", conditions[cond].torder, "itype:", conditions[cond].itype, "issue:", getIssue(conditions[cond].issue), "url:", conditions[cond].url);
        }

    }


    $(document).ready(function(){
        $(".participant-id").text(pid);
        $("#preQ").attr("href", preQ);
        $(".preArticleQ").attr("href", preArticleQ);
        $(".postArticleQ").attr("href", postArticleQ);
        $("#finalQ").attr("href", finalQ);
        $("a").click(function(){
            $(this).closest("h4").find(".progress").html("V&nbsp;&nbsp;");
            // Log.add("study.html", "click", {"pid": pid, "url": $(this).attr("href")});
        });

        var numTasks = 3;
        var pnum = parseInt(pid.substr(1));
        var itype = pid[0];
        var starting = 0;
        if (pnum < 1 || pnum > 12){
            alert("잘못된 사용자 ID 입니다.");
            $("#main").hide();
        }
        if (itype != "A" && itype != "B" && itype != "C"){
            alert("잘못된 사용자 ID 입니다.");
            $("#main").hide();
        }


        console.log("pnum", pnum, "itype", itype);

        $(".instruction").text(getInstruction(itype));

        if (itype == "A") {
            $("#tutorialQ").attr("href", tutorialQA);
            $("#postQ").attr("href", postQA);
        } else if (itype == "B") {
            $("#tutorialQ").attr("href", tutorialQB);
            $("#postQ").attr("href", postQB);
        }
        else if (itype == "C") {
            $("#tutorialQ").attr("href", tutorialQC);
            $("#postQ").attr("href", postQC);
        }

        createTasks(itype);

        for (i = 1; i <= numTasks; i++) {
            if (itype == "A")
                starting = 0;
            else if (itype == "B")
                starting = 36;
            else if (itype == "C")
                starting = 72;
            console.log("TASK #", starting + (pnum - 1) * numTasks + i);
            task = conditions[starting + (pnum - 1) * numTasks + i];
            $("#issue" + i).text(getIssue(task.issue));
            $("#explore" + i).attr("href", task.url);
        }
    });
    </script>

</body>
</html>
